# Building the TableIO library
#
# ATTENTION: The file is used by Basin Modeling and Geocase.
#
include_directories(src)

set (generater_sorce_files
  ${CMAKE_CURRENT_BINARY_DIR}/cauldronschema.C 
  ${CMAKE_CURRENT_BINARY_DIR}/cauldronschemafuncs.C
  ${CMAKE_CURRENT_BINARY_DIR}/cauldronschema.h
  ${CMAKE_CURRENT_BINARY_DIR}/cauldronschemafuncs.h
  )

add_library( TableIO
	src/dataschema.C
	src/database.C
	src/datautils.C
	${generater_sorce_files}
)

include_directories(${CMAKE_CURRENT_BINARY_DIR})

# cauldronschema and cauldronschemafuncs have to be generated by the the 'parspec' tool
add_executable( parspec 
   src/parspec.C
   src/datautils.C
)

get_target_property(PARSPEC_EXEC parspec LOCATION)


add_custom_command( OUTPUT ${generater_sorce_files}
	DEPENDS parspec
	WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
	COMMAND ${PARSPEC_EXEC} 
	ARGS -schema CauldronSchema -directory ${CMAKE_CURRENT_BINARY_DIR} -input BasinModellerProperty.Spec 
)

generate_dox( src/tableio.cfg )

install(TARGETS TableIO
	RUNTIME DESTINATION bin
	LIBRARY	DESTINATION lib
	ARCHIVE DESTINATION lib
)

